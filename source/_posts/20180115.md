---
title: vue之table组件的开发
date: 2018-01-15 11:52:28
tags: [vue, 组件, table]
cdn: 'header-off'
position: '/2018/01/13/20180115/'
header-img: "head.jpg"
---

> 响应上级领导要求，开发一套vue的table组件，通过零零散散的时间算是基本上写完了。今天就来总结一下吧。

# 设计文档

为了开发过程中有一个参照，所以简单的写了一个计划。

![设计计划文档](jihua1.jpg)
![设计计划文档](jihua2.jpg)
![设计计划文档](jihua3.jpg)

一个大而全的表格组件即将在我手中诞生了，想想就有点小激动。给领导看过之后说了一句话，让我受益匪浅，赶紧记录一下，大意就是

    “并不是大而全就好用，重要的是要让别人觉得好用，可以用。”

反思总结了一下，重新整理计划，发现先前设计的搜索区域和工具区域其实很难控制好，因为不同的项目界面设计上差别很大，因此去除了这两部分。还有之前是想传url给组件，然后组件内部去请求后台数据，这样组也很难控制，还是传递数据给组件这样比较好。

设计好了就开工吧

### 开发要点、难点

1. 为完成表头表体分离的功能，表头和表体需要两个table，这就需要维护每个表头和相应表体的对齐关系。

2. 为了完成列固定的功能，同样需要table，又要维护对齐关系了。

3. 如果表体滚动时会产生滚动条，所以表头需要留出相应大小的位置。

4. 行合并，列合并的功能。

5. 表头分组功能数据处理。

### 开发思路

用户将表头信息columns、表格数据data、参数信息options传给组件。

表头数据示例内容如下：title显示的文字；type表示这一列的类型，包括selection（选择）、detail（详情）；key对应数据，用于获取数据；width设置当前列的宽度；aligin内容对齐方式；fixed固定列位置；sortable是否可以排序；children表示分组；render渲染的内容，可以自定义处理内容。

```
columns: [
  {
    type: 'selection',
    key: 'selection',
    width: 60,
    align: 'center',
    fixed: 'left'
  },
  {
    title: "姓名",
    key: 'name',
    sortable: true
  },
  {
    title: '其他',
    fixed: "left",
    children: [
      {
        title: '年龄',
        key: 'age',
        sortable: (a, b, isAsc) => {
          if (isAsc) {
            return a - b;
          } else {
            return b - a;
          }
        }
      },
      {
        title: '地址',
        key: 'address',
        children: [
          {
            title: '街道',
            key: 'street',
          },
          {
            title: '街区',
            key: 'block',
            children: [
              {
                title: '楼栋',
                key: 'building',
              },
              {
                title: '门牌号',
                key: 'number',
              }
            ],
          }
        ],
      }
    ],
  },
  {
    title: '公司',
    key: 'company',
    children: [
      {
        title: '公司地址',
        key: 'companyAddress'
      },
      {
        title: '公司名称',
        key: 'companyName'
      }
    ],
  },
  {
    title: '性别',
    key: 'gender',
  },
  {
    title: "操作",
    key: 'render',
    type: "render",
    fixed: "right",
    width: 210,
    render: (h, params) => {
      return [
        h('Button', {
          props: {
            type: "primary",
            size: "small"
          },
          on: {
            click: function() {
              console.log('你点击了删除按钮');
            }
          }
        }, '删除'),
        h('Button', {
          props: {
            type: "primary",
            size: "small"
          }
        }, '修改')
      ]
    }
  }
]
```



### 遇到的问题